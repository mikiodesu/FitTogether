<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-6">

      <div class="card shadow-sm p-4">
        <h1 class="mb-4 text-center">New Post</h1>

        <%= form_with model: @workout, local: true, class: "needs-validation" do |f| %>
          <% if @workout.errors.any? %>
            <div class="alert alert-danger">
              <h5><%= pluralize(@workout.errors.count, "エラー") %>があります:</h5>
              <ul>
                <% @workout.errors.full_messages.each do |msg| %>
                  <li><%= msg %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <div class="mb-3">
            <%= f.label :date, "トレーニング日", class: "form-label" %>
            <%= f.date_field :date, class: "form-control" %>
          </div>

          <div class="mb-3">
            <%= f.label :memo, "一言メモ", class: "form-label" %>
            <%= f.text_area :memo, class: "form-control", rows: 3 %>
          </div>

          <div class="mb-3">
            <%= f.label :is_public, "公開設定", class: "form-label" %>
            <%= f.select :is_public, [["公開", true], ["非公開", false]], {}, class: "form-select" %>
          </div>

          <h3 class="mt-4 mb-3 text-center">トレーニング詳細</h3>

          <div id="workout_details" class="mb-3">
            <%= f.fields_for :workout_details do |detail_form| %>
              <%= render 'workout_detail_fields', f: detail_form %>
            <% end %>
          </div>

          <div class="mb-3 text-center">
            <button type="button" id="add_workout_detail" class="btn btn-outline-primary">
              ＋種目を追加
            </button>
          </div>

          <div class="text-center">
            <%= f.submit "投稿", class: "btn btn-success" %>
          </div>

          <!-- 追加用フォームのテンプレート -->
          <script type="text/template" id="workout_detail_template">
            <%= j(
              f.fields_for(:workout_details, WorkoutDetail.new, child_index: "new_workout_details") do |detail_form|
                render('workout_detail_fields', f: detail_form)
              end
            ) %>
          </script>

        <% end %>
      </div>

    </div>
  </div>
</div>